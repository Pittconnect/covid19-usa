(this["webpackJsonpcovid19-usa"]=this["webpackJsonpcovid19-usa"]||[]).push([[0],{22:function(e,t,a){e.exports=a(34)},27:function(e,t,a){},31:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(18),r=a.n(i),c=(a(27),a(21)),o=a(5),s=a(7),u={id:"county-bound",type:"fill",source:"counties",minzoom:5,layout:{},filter:["==","$type","Polygon"],paint:{"fill-color":"#FFFFFF","fill-opacity":["case",["boolean",["feature-state","hover"],!1],.6,.2]}},d={id:"county-border",type:"line",source:"counties",minzoom:5,layout:{},paint:{"line-color":"#FFFFFF","line-opacity":["case",["boolean",["feature-state","hover"],!1],1,.5],"line-width":1.4}},b={id:"state-bound",source:"states",maxzoom:5,type:"fill",layout:{},paint:{"fill-color":"#30cbef","fill-opacity":["case",["boolean",["feature-state","hover"],!1],.6,.2]}},h={id:"state-borders",type:"line",source:"states",layout:{},paint:{"line-color":"#0fa2c4","line-opacity":["case",["boolean",["feature-state","hover"],!1],1,.5],"line-width":["interpolate",["linear"],["zoom"],5,2,6,6]}},m=(a(31),function(){return l.a.createElement("div",{className:"cssload-container"},l.a.createElement("div",{className:"cssload-circle-1"},l.a.createElement("div",{className:"cssload-circle-2"},l.a.createElement("div",{className:"cssload-circle-3"},l.a.createElement("div",{className:"cssload-circle-4"},l.a.createElement("div",{className:"cssload-circle-5"},l.a.createElement("div",{className:"cssload-circle-6"},l.a.createElement("div",{className:"cssload-circle-7"},l.a.createElement("div",{className:"cssload-circle-8"})))))))))}),f=function(e,t,a){var n=Math.trunc(e/t);return{getX:function(){var l=e/n-t;return(t+l)*(a%n)+l/2},getY:function(e,t,l,i){var r=l+i,c=e/Math.trunc(e/(t+r))-t;return(t+c)*Math.trunc(a/n)+c/2}}},v=function(e){var t=e.containerWidth,a=e.containerHeight,i=e.elementWidth,r=e.elementHeight,c=e.paddingTop,s=e.paddingBottom,u=e.elementLabel,d=e.elementFontSize,b=e.elementIndex,h=e.colorScale,m=Object(n.useState)(0),v=Object(o.a)(m,2),g=v[0],p=v[1],O=Object(n.useState)(0),j=Object(o.a)(O,2),E=j[0],y=j[1];return Object(n.useEffect)((function(){p(f(t,i,b).getX()),y(f(t,i,b).getY(a,r,c,s))}),[t,a,i,r,b,c,s]),l.a.createElement(l.a.Fragment,null,l.a.createElement("rect",{width:i,height:r,fill:h(u),x:g,y:E}),l.a.createElement("text",{fill:"#fff",x:g+2,y:E+d+2,fontSize:d,textAnchor:"start",alignmentBaseline:"baseline"},u))},g=[{label:"Alabama",value:"AL",id:"01"},{label:"Alaska",value:"AK",id:"02"},{label:"American Samoa",value:"AS",id:"60"},{label:"Arizona",value:"AZ",id:"04"},{label:"Arkansas",value:"AR",id:"05"},{label:"California",value:"CA",id:"06"},{label:"Colorado",value:"CO",id:"08"},{label:"Connecticut",value:"CT",id:"09"},{label:"Delaware",value:"DE",id:"10"},{label:"District of Columbia",value:"DC",id:"11"},{label:"States of Micronesia",value:"FM",id:"64"},{label:"Florida",value:"FL",id:"12"},{label:"Georgia",value:"GA",id:"13"},{label:"Guam",value:"GU",id:"66"},{label:"Hawaii",value:"HI",id:"15"},{label:"Idaho",value:"ID",id:"16"},{label:"Illinois",value:"IL",id:"17"},{label:"Indiana",value:"IN",id:"18"},{label:"Iowa",value:"IA",id:"19"},{label:"Kansas",value:"KS",id:"20"},{label:"Kentucky",value:"KY",id:"21"},{label:"Louisiana",value:"LA",id:"22"},{label:"Maine",value:"ME",id:"23"},{label:"Marshall Islands",value:"MH",id:"68"},{label:"Maryland",value:"MD",id:"24"},{label:"Massachusetts",value:"MA",id:"25"},{label:"Michigan",value:"MI",id:"26"},{label:"Minnesota",value:"MN",id:"27"},{label:"Mississippi",value:"MS",id:"28"},{label:"Missouri",value:"MO",id:"29"},{label:"Montana",value:"MT",id:"30"},{label:"Nebraska",value:"NE",id:"31"},{label:"Nevada",value:"NV",id:"32"},{label:"New Hampshire",value:"NH",id:"33"},{label:"New Jersey",value:"NJ",id:"34"},{label:"New Mexico",value:"NM",id:"35"},{label:"New York",value:"NY",id:"36"},{label:"North Carolina",value:"NC",id:"37"},{label:"North Dakota",value:"ND",id:"38"},{label:"Northern Mariana Islands",value:"MP",id:"69"},{label:"Ohio",value:"OH",id:"39"},{label:"Oklahoma",value:"OK",id:"40"},{label:"Oregon",value:"OR",id:"41"},{label:"Palau",value:"PW",id:"70"},{label:"Pennsylvania",value:"PA",id:"42"},{label:"Puerto Rico",value:"PR",id:"72"},{label:"Rhode Island",value:"RI",id:"44"},{label:"South Carolina",value:"SC",id:"45"},{label:"South Dakota",value:"SD",id:"46"},{label:"Tennessee",value:"TN",id:"47"},{label:"Texas",value:"TX",id:"48"},{label:"Utah",value:"UT",id:"49"},{label:"Vermont",value:"VT",id:"50"},{label:"Virgin Islands",value:"VI",id:"78"},{label:"Virginia",value:"VA",id:"51"},{label:"Washington",value:"WA",id:"53"},{label:"West Virginia",value:"WV",id:"54"},{label:"Wisconsin",value:"WI",id:"55"},{label:"Wyoming",value:"WY",id:"56"}],p=4,O=22,j=5,E=[[-179.99,16.01619],[-64.46466,71.757764]],y=["rgba(129, 197, 64, 1)","rgba(245, 181, 46, 1)","rgba(237, 91, 53, 1)","rgba(0,0,0, 1)"],w=["rgb(97, 46, 141)","rgb(245, 181, 46)"],S=window.d3,N=function(e){var t=e.data,a=e.sqrtScale,n=e.colorScale,i=e.width,r=e.top,c=e.left;return l.a.createElement("circle",{r:a(t.value),cx:i/2-c,cy:r,fill:n(t.name)})},x=function(e){var t=e.legendWidth,a=e.legendHeight,n=e.legendTop,i=e.legendRight,r=e.legendBottom,c=e.legendLeft,o=e.useLegend,s=e.legendOnRight,u=void 0===s||s,d=e.data.totalTestResults,b=e.data.hospitalizedCurrently,h=u?e.height:e.height-a,m=S.scaleSqrt().domain([0,e.maxTotalTests.totalTestResults+e.maxTotalTests.hospitalizedCurrently]).range([0,(h-e.top-e.bottom)/2]),f=S.scaleOrdinal().domain(e.data).range(y),g=u?170:180;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h1",{className:"chart-header"},"State: ".concat(e.data.stateName)),l.a.createElement("svg",{width:e.width,height:e.height},l.a.createElement("g",{transform:"translate(".concat(0,", ",0,")")},e.dataKeys.map((function(n,i){return l.a.createElement(N,{key:i,data:{name:Object.keys(n)[0],value:e.data[Object.keys(n)[0]]},width:u?e.width-t:e.width,height:u?e.height:e.height-a,top:u?a/2+e.top<m(d)+e.top?m(d)+e.top:a/2+e.top:m(d)+a,right:e.right,bottom:e.bottom,left:n.hospitalizedCurrently?m(d)-m(b)+m(e.data[Object.keys(n)[0]]):m(d)-m(b)-m(e.data[Object.keys(n)[0]]),sqrtScale:m,colorScale:f})}))),o&&l.a.createElement("g",{transform:"translate(".concat(u?"".concat(e.width-g-c-i,", ").concat(a/2+e.top<m(d)+e.top?m(d)-a/2+e.top:e.top):"".concat(0,", ",0),")")},e.dataKeys.map((function(o,s){return l.a.createElement(v,{key:s,containerWidth:t,containerHeight:a,elementWidth:g,elementHeight:26,paddingTop:n,paddingRight:i,paddingBottom:r,paddingLeft:c,elementLabel:"".concat(Object.values(o)[0],": ").concat(e.data[Object.keys(o)[0]]||0),elementFontSize:17,elementIndex:s,colorScale:f})})))))},I=function(e){var t=e.x,a=e.y,n=e.width,i=e.height,r=e.fill;e.showPercentage;return l.a.createElement("rect",{x:t,y:a,width:n,height:i,fill:r})},T=function(e){var t=e.translateX,a=e.translateY,n=e.textAnchor,i=e.alignmentBaseline,r=e.fill,c=e.fontSize,o=e.text;return l.a.createElement("text",{transform:"translate(".concat(t,", ").concat(a,")"),textAnchor:n,alignmentBaseline:i,fill:r,fontSize:c},o)},C=function(e){var t=e.data,a=e.x,n=e.y,i=e.width,r=e.height,c=e.fill,o=e.fontSize,s=e.fontColor;return l.a.createElement(l.a.Fragment,null,l.a.createElement(I,{x:a,y:n,width:i,height:r,fill:c}),l.a.createElement("text",{x:a+2,y:n+o+4,fontSize:o,fill:s},"".concat(t.key,": ").concat(t.value)))},R=window.d3,k=function(e){var t=e.width,a=e.height,n=e.top,i=e.right,r=e.bottom,c=e.left,o=e.data,s=e.showLegend,u=e.legendData,d=e.showPercentage,b=void 0===d||d,h=t-c-i,m=a-n-r,f=m/3,v=m-f,g=R.scaleOrdinal().domain(o.map((function(e,t){return t}))).range(w),p=R.scaleLinear().domain([0,R.max(o)]).range([0,h]),O=R.scaleBand().range([0,v]).domain(o.map((function(e,t){return t}))).padding(.1),j=R.scaleOrdinal().domain(u).range(w),E=R.scaleBand().range([0,h]).domain(u).paddingInner(.1),y=R.format(".2f"),S=function(e){return e<38?38:e};return l.a.createElement("svg",{width:t,height:a},l.a.createElement("g",{transform:"translate(".concat(c,", ").concat(n,")")},o.map((function(e,t){return l.a.createElement(l.a.Fragment,{key:t},l.a.createElement(I,{key:t,x:p(0),y:O(t),width:p(e),height:O.bandwidth(),fill:g(t)}),b&&l.a.createElement(T,{translateX:S(p(e)-2),translateY:O(t)+O.bandwidth()/2+4,textAnchor:"end",alignmentBaseline:"baseline",fill:"#fff",fontSize:12,text:"".concat(y(100*e/R.max(o)),"%")}))})),s&&u.map((function(e,t){return l.a.createElement(C,{key:t,data:{key:e,value:o[t]},x:E(e),y:v+r,width:E.bandwidth(),height:f-r,fill:j(e),fontSize:15,fontColor:"#fff"})}))))},M=function(e){var t=e.chartHeaders,a=void 0===t?[{key:"null",value:"null"}]:t,n=e.chartData;return l.a.createElement(l.a.Fragment,null,a.map((function(e,t){return l.a.createElement("h1",{className:"chart-header",key:t},"".concat(e.key,": ").concat(e.value))})),0!==n.length?l.a.createElement(k,{width:360,height:140,data:n,top:10,right:10,bottom:10,left:10,showLegend:!0,legendData:["Max RSEI","County RSEI"]}):l.a.createElement("h1",{className:"chart-header",style:{paddingTop:"10px"}},"RSEI Score: NO DATA"))},F=a(15),A=a.n(F),z=a(20),H=a(9),L=function(e,t){switch(t.type){case"FETCH_INIT":return Object(H.a)(Object(H.a)({},e),{},{isLoading:!0,error:null});case"FETCH_SUCCESS":return Object(H.a)(Object(H.a)({},e),{},{isLoading:!1,error:null,data:t.payload});case"FETCH_ERROR":return Object(H.a)(Object(H.a)({},e),{},{isLoading:!1,error:t.error});default:throw new Error("Not suppored action")}};var D=window.d3,W=function(){var e=Object(n.useState)({latitude:40.54097864298709,longitude:-99.81367290280828,zoom:p,bearing:0,pitch:0}),t=Object(o.a)(e,2),i=t[0],r=t[1],f=Object(n.useState)(!1),v=Object(o.a)(f,2),y=v[0],w=v[1],S=Object(n.useState)({}),N=Object(o.a)(S,2),I=N[0],T=N[1],C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(n.useState)(e),l=Object(o.a)(a,2),i=l[0],r=l[1],c=Object(n.useState)(t),s=Object(o.a)(c,2),u=s[0],d=s[1],b=Object(n.useReducer)(L,{data:null,isLoading:!1,error:null}),h=Object(o.a)(b,2),m=h[0],f=h[1];return Object(n.useEffect)((function(){(function(){var e=Object(z.a)(A.a.mark((function e(){var t,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f({type:"FETCH_INIT"}),e.prev=1,e.next=4,fetch(i,u);case 4:if(!((t=e.sent).status<200||t.status>=300)){e.next=7;break}throw new Error("Error fetching data");case 7:return e.next=9,t.json();case 9:a=e.sent,f({type:"FETCH_SUCCESS",payload:a}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),f({type:"FETCH_ERROR",error:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}})()()}),[i,u]),[m,r,d]}("https://covidtracking.com/api/v1/states/current.json"),R=Object(o.a)(C,1)[0],k=R.data,F=R.isLoading,H=R.error,W=Object(n.useState)(!1),B=Object(o.a)(W,2),P=B[0],V=B[1],K=Object(n.useState)(0),U=Object(o.a)(K,2),Y=U[0],G=U[1],J=Object(n.useState)(0),Z=Object(o.a)(J,2),_=Z[0],X=Z[1],q=Object(n.useState)({}),$=Object(o.a)(q,2),Q=$[0],ee=$[1],te=Object(n.useState)({}),ae=Object(o.a)(te,2),ne=ae[0],le=ae[1],ie=Object(n.useState)([]),re=Object(o.a)(ie,2),ce=re[0],oe=re[1],se=Object(n.useState)([]),ue=Object(o.a)(se,2),de=ue[0],be=ue[1],he=Object(n.useState)(!1),me=Object(o.a)(he,2),fe=me[0],ve=me[1],ge=Object(n.useState)([]),pe=Object(o.a)(ge,2),Oe=pe[0],je=pe[1],Ee=Object(n.useState)(!1),ye=Object(o.a)(Ee,2),we=ye[0],Se=ye[1],Ne=Object(n.useState)([]),xe=Object(o.a)(Ne,2),Ie=xe[0],Te=xe[1],Ce=Object(n.useState)(!1),Re=Object(o.a)(Ce,2),ke=Re[0],Me=Re[1],Fe=Object(n.useRef)(),Ae=Object(n.useRef)(),ze=Object(n.useRef)(null),He=Object(n.useRef)(null),Le=Object(n.useRef)(!0),De=function(e){var t=e.properties.NAME,a=g.find((function(e){return e.label===t})),n=k.find((function(e){return e.state===a.value})),l=n.positive,i=n.hospitalizedCurrently,r=n.hospitalizedCumulative,c=n.death,o=n.totalTestResults;H||ee({positive:l,hospitalizedCurrently:r||i,death:c,totalTestResults:o,stateName:t})},We=function(e){var t,a=e.properties,n=a.GEO_ID,l=a.STATE,i=a.NAME,r=n.includes("US0")?n.indexOf("US0")+3:n.indexOf("US")+2,c=n.substring(r,n.length),o=g.find((function(e){return e.id===l})).label,s=null===(t=ce[c])||void 0===t?void 0:t[0]["RSEI Score"];le({headers:[{key:"State",value:o},{key:"County",value:i}],data:[s]})};return Object(n.useEffect)((function(){!y||F||we||fe||ke?V(!0):(G(k.slice().sort((function(e,t){return D.descending(e.totalTestResults,t.totalTestResults)}))[0]),oe(D.nest().key((function(e){return e.FIPS})).object(Ie)),X(D.max(Ie,(function(e){return e["RSEI Score"]}))),V(!1))}),[y,F,k,Ie,fe,ke,we]),Object(n.useEffect)((function(){ve(!0),Se(!0),Me(!0),a.e(5).then(a.t.bind(null,35,3)).then((function(e){be(e.default),ve(!1)})),a.e(4).then(a.t.bind(null,36,3)).then((function(e){je(e.default),Se(!1)})),a.e(3).then(a.t.bind(null,37,3)).then((function(e){Te(e.default),Me(!1)}))}),[]),l.a.createElement("div",{className:"map-container"},P&&l.a.createElement("div",{className:"map-spinner"},l.a.createElement(m,null)),l.a.createElement(s.f,Object.assign({},i,{ref:Fe,width:"100vw",height:"100vh",mapboxApiAccessToken:"pk.eyJ1IjoiYWxleG5vcnZhZyIsImEiOiJjam1ia2ZoMmQwbDgxM3BxNHN1bGJrZmtqIn0.ac7-waXEpU58Rf5FGn8JbA",mapStyle:"mapbox://styles/alexnorvag/ck9efq0oz2d0x1ioftrtazzyz",onViewStateChange:function(e){var t=e.viewState,a=t.width,n=t.height,l=new s.e(t),i=l.unproject([0,0]),c=l.unproject([a,n]);if(i[0]<E[0][0]){var o=l.project(E[0]),u=l.unproject([(a-1)/2+o[0],n]);t.longitude=u[0]}if(i[1]>E[1][1]){var d=l.project(E[1]),b=l.unproject([a,(n-1)/2+d[1]]);t.latitude=b[1]}if(c[0]>E[1][0]){var h=l.project(E[1]),m=a-h[0],f=l.unproject([(h[0]-1-m)/2,n]);t.longitude=f[0]}if(c[1]<E[0][1]){var v=l.project(E[0]),g=n-v[1],p=l.unproject([a,(v[1]-1-g)/2]);t.latitude=p[1]}r(t)},onLoad:function(){return w(!0)},onHover:function(e){if(y){var t=Fe.current.getMap(),a=t.getZoom(),n=a>j?"counties":"states",l=e.features,i=e.lngLat,r=l.find((function(e){return"state-bound"===e.layer.id||"county-bound"===e.layer.id}));if(r){var c=Object(o.a)(i,2),s=c[0],u=c[1];T({longitude:s,latitude:u}),a<j?(le({}),De(r)):(ee({}),We(r)),He.current&&t.setFeatureState({source:He.current,id:ze.current},{hover:!1}),ze.current=r.id,He.current=r.source,t.setFeatureState({source:He.current,id:ze.current},{hover:!0})}else T({}),t.setFeatureState({source:He.current||n,id:ze.current},{hover:!1}),ze.current=null,He.current=null}},minZoom:p,maxZoom:O}),0!==Object.entries(I).length&&l.a.createElement(s.c,{latitude:I.latitude,longitude:I.longitude,closeButton:!1,anchor:"bottom-right"},l.a.createElement("div",{className:"popup-container"},l.a.createElement("div",{className:"popup-chart"},i.zoom<j?0!==Object.entries(Q).length&&l.a.createElement(x,{data:Q,dataKeys:[{totalTestResults:"Total"},{positive:"Positive"},{hospitalizedCurrently:"Hospitalized"},{death:"Death"}],maxTotalTests:{totalTestResults:Y.totalTestResults,hospitalizedCurrently:Y.hospitalizedCumulative||Y.hospitalizedCurrently},width:Le.current?550:420,height:Le.current?280:360,top:10,bottom:10,left:10,right:10,legendWidth:Le.current?180:420,legendHeight:Le.current?150:80,legendTop:5,legendRight:10,legendBottom:5,legendLeft:10,useLegend:!0,legendOnRight:Le.current}):0!==Object.entries(ne).length&&l.a.createElement(M,{chartHeaders:ne.headers,chartData:ne.data[0]?[_].concat(Object(c.a)(ne.data)):[]})))),0!==de.length&&l.a.createElement(s.d,{id:"counties",type:"geojson",data:de,ref:Ae,generateId:!0},l.a.createElement(s.a,Object.assign({},u,{beforeId:"waterway-label"})),l.a.createElement(s.a,Object.assign({},d,{beforeId:"waterway-label"}))),0!==Oe.length&&l.a.createElement(s.d,{id:"states",type:"geojson",data:Oe,ref:Ae,generateId:!0},l.a.createElement(s.a,Object.assign({},b,{beforeId:"waterway-label"})),l.a.createElement(s.a,Object.assign({},h,{beforeId:"waterway-label"}))),l.a.createElement("div",{className:"map-navigation"},l.a.createElement(s.b,{showCompass:!1}))))};a(33);var B=function(){return l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"App-container"},l.a.createElement("div",{className:"covid-map"},l.a.createElement(W,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.9b1a61a3.chunk.js.map